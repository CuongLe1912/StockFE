<div class="kt-portlet__left" *ngIf="forms && forms.length > 0">
    <ul>
        <li>
            <a class="btn btn-icon btn-warning btn-lg" (click)="clearFormComponent()">
                <span class="svg-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <rect x="0" y="0" width="24" height="24"></rect>
                            <path d="M3,16 L5,16 C5.55228475,16 6,15.5522847 6,15 C6,14.4477153 5.55228475,14 5,14 L3,14 L3,12 L5,12 C5.55228475,12 6,11.5522847 6,11 C6,10.4477153 5.55228475,10 5,10 L3,10 L3,8 L5,8 C5.55228475,8 6,7.55228475 6,7 C6,6.44771525 5.55228475,6 5,6 L3,6 L3,4 C3,3.44771525 3.44771525,3 4,3 L10,3 C10.5522847,3 11,3.44771525 11,4 L11,19 C11,19.5522847 10.5522847,20 10,20 L4,20 C3.44771525,20 3,19.5522847 3,19 L3,16 Z" fill="#000000" opacity="0.3"></path>
                            <path d="M16,3 L19,3 C20.1045695,3 21,3.8954305 21,5 L21,15.2485298 C21,15.7329761 20.8241635,16.200956 20.5051534,16.565539 L17.8762883,19.5699562 C17.6944473,19.7777745 17.378566,19.7988332 17.1707477,19.6169922 C17.1540423,19.602375 17.1383289,19.5866616 17.1237117,19.5699562 L14.4948466,16.565539 C14.1758365,16.200956 14,15.7329761 14,15.2485298 L14,5 C14,3.8954305 14.8954305,3 16,3 Z" fill="#000000"></path>
                        </g>
                    </svg>
                </span>
            </a>
        </li>
        <li *ngFor="let item of forms; let i = index">
            <a class="btn btn-icon btn-success btn-lg" (click)="renderFormComponent(item)">
                {{ i + 1 }}
            </a>
        </li>
    </ul>
</div>
<div class="kt-portlet kt-portlet-grid kt-portlet--mobile" *ngIf="obj" [ngClass]="{'kt-portlet-popup':obj.IsPopup, 'kt-margin-left': forms && forms.length > 0}">
    <div class="kt-portlet__head kt-portlet__head--lg" *ngIf="!obj.HideHeadActions">
        <style>
            thead tr th {
                top: 0;
                z-index: 96;
                position: sticky;
                background: #efefef;
            }

            thead {
                font-weight: 500;
                color: rgba(0, 0, 0, 0.85);
            }

            tbody tr:hover {
                background: #e6f7ff;
            }
        </style>
        <div class="page-bar">
            <ul class="page-breadcrumb" *ngIf="breadcrumbs && breadcrumbs.length > 0">
                <li *ngFor="let item of breadcrumbs; let i = index;">
                    <a [routerLink]="item.Link" *ngIf="item.Link">{{ item.Name }}</a>
                    <span *ngIf="!item.Link">{{ item.Name }}</span>
                    <i class="fa fa-angle-right" *ngIf="i < breadcrumbs.length - 1"></i>
                </li>
            </ul>
        </div>
        <div class="kt-portlet__head-actions">
            <div class="inline-filter-group" *ngIf="inlineFilters && inlineFilters.length > 0">
                <div class="kt-margin-r-10" [ngStyle]="{width: property.dataType == DataType.DateTime && property.type != DateTimeType.DateMonth ? '400px' : '200px'}" *ngFor="let property of inlineFilters">
                    <ng-container [ngSwitch]="property.dataType">
                        <ng-container *ngSwitchCase="DataType.DateTime">
                            <ng-container *ngIf="property.type == DateTimeType.DateMonth">
                                <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ label: '', format: property.format, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false}" (valueChange)="inlineFilter()"></editor>
                            </ng-container>
                            <ng-container *ngIf="property.type != DateTimeType.DateMonth">
                                <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ label: '', format: property.format, type: DateTimeType.DateRange, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false}" (valueChange)="inlineFilter()"></editor>
                            </ng-container>
                        </ng-container>
                        <ng-container *ngSwitchCase="DataType.DropDown">
                            <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ label: '', type: DataType.DropDown, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false }" (valueChange)="inlineFilter()"></editor>
                        </ng-container>
                        <ng-container *ngSwitchCase="DataType.String">
                            <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ label: '', required: false, allowClear: property.allowClear, autoSelect: false, readonly: false}" (keyPressEnter)="inlineFilter()" (clearValue)="inlineFilter()"></editor>
                        </ng-container>
                        <ng-container *ngSwitchDefault>
                            <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ label: '', required: false, allowClear: property.allowClear, autoSelect: false, readonly: false}" (valueChange)="inlineFilter()"></editor>
                        </ng-container>
                    </ng-container>
                </div>
            </div>
            <div class="input-group" *ngIf="!obj.HideSearch">
                <div class="kt-input-icon kt-input-icon--right">
                    <input type="text" class="form-control form-control-search" [placeholder]="obj.SearchText || 'Tìm kiếm...'" [(ngModel)]="itemData.Search" (keyup.enter)="search()" (ngModelChange)="clearSearch()" (blur)="onSearchBoxBlur()" (keydown)="onSearchBoxKeypress($event)" maxlength="100">
                    <span class="kt-input-icon__icon kt-input-icon__icon--right" *ngIf="itemData.Search" (click)="clickClearSearch()">
                        <span><i class="la la-close"></i></span>
                    </span>
                </div>
                <div class="input-group-append">
                    <button class="btn btn-primary" type="button" (click)="search()">
                        <i class="la la-search"></i><span>Tìm</span>
                    </button>
                </div>
            </div>
            <div class="button-group">
                <div class="dropdown" *ngIf="!obj.HideCustomFilter && customFilters && customFilters.length > 0">
                    <button type="button" class="btn-icon-sm" (click)="activeCustomFilter = !activeCustomFilter" [ngClass]="activeCustomFilter ? 'btn btn-success' : 'btn btn-default'">
                        <span>Lọc dữ liệu</span>
                        <i style="padding: 0 5px 0 15px;" [ngClass]="activeCustomFilter ? 'la la-angle-double-up' : 'la la-angle-double-down'"></i>
                    </button>
                </div>
                <div class="dropdown dropdown-request-filter" *ngIf="requestFilters && requestFilters.length > 0" [ngClass]="{'show':activeRequestFilter}" (clickOutside)="activeRequestFilter = false">
                    <button type="button" class="btn-icon-sm btn btn-default" (click)="activeRequestFilter = !activeRequestFilter">
                        <i class="la la-filter"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right" [ngClass]="{'show':activeRequestFilter}" style="z-index: 99">
                        <ul class="kt-nav">
                            <li class="kt-nav__item" *ngFor="let item of requestFilters">
                                <a class="kt-nav__link d-flex justify-content-between align-items-center" style="width: 100%;">
                                    <span class="kt-nav__link-text" (click)="filterByRequestFilter(item)">{{ item.Name }}</span>
                                    <i class="la la-close" (click)="deleteRequestFilter(item)"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="dropdown" *ngIf="obj.StatisticalComponent">
                    <button type="button" class="btn-icon-sm" (click)="toggleActiveStatisticalComponent()" [ngClass]="activeStatisticalComponent ? 'btn btn-success' : 'btn btn-default'">
                        <span>Thống kê</span>
                        <i style="padding: 0 5px 0 15px;" [ngClass]="activeStatisticalComponent ? 'la la-angle-double-up' : 'la la-angle-double-down'"></i>
                    </button>
                </div>
                <dropdown *ngIf="obj.Imports && obj.Imports.length > 0" [items]="obj.Imports" text="Nhập dữ liệu" subText="Định dạng" icon="la la-upload" cssClass="btn-default"></dropdown>
                <dropdown *ngIf="obj.Exports && obj.Exports.length > 0" [items]="obj.Exports" text="Xuất dữ liệu" subText="Định dạng" icon="la la-download" cssClass="btn-default"></dropdown>
                <dropdown *ngIf="obj.Filters && obj.Filters.length > 0" [items]="obj.Filters" text="Xem dữ liệu" subText="Chọn hình thức" icon="la la-filter" cssClass="btn-default"></dropdown>
                <dropdown *ngIf="moreFeatures && moreFeatures.Actions && moreFeatures.Actions.length > 0" [items]="moreFeatures.Actions" [text]="moreFeatures.Name" [icon]="moreFeatures.Icon" cssClass="btn-default"></dropdown>
                <div class="dropdown" *ngIf="obj.Features && obj.Features.length > 0">
                    <ng-container *ngFor="let item of obj.Features">
                        <a [ngClass]="item.className" (click)="item.click()" *ngIf="!item.hide" [attr.tooltip]="item.tooltip">
                            <i [ngClass]="item.icon"></i>
                            <span> {{ item.name }}</span>
                        </a>
                    </ng-container>
                </div>
            </div>
        </div>
    </div>
    <div class="kt-portlet__body kt-portlet__form" [ngClass]="obj.ClassName">
        <div class="kt-portlet-statistical" *ngIf="activeStatisticalComponent">
            <ng-template #container></ng-template>
        </div>
        <form class="kt-form kt-form--fit" *ngIf="!obj.HideCustomFilter && customFilters && customFilters.length > 0" [ngClass]="{'active' : activeCustomFilter }">
            <div class="row">
                <div class="col-lg-3 kt-margin-t-15" *ngFor="let property of customFilters">
                    <ng-container [ngSwitch]="property.dataType">
                        <ng-container *ngSwitchCase="DataType.DateTime">
                            <ng-container *ngIf="property.type == DateTimeType.DateMonth">
                                <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ format: property.format, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: '', placeholder: property.placeholder}" (valueChange)="autoCustomFilter(property)"></editor>
                            </ng-container>
                            <ng-container *ngIf="property.type != DateTimeType.DateMonth">
                                <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ format: property.format, type: DateTimeType.DateRange, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: '', placeholder: property.placeholder}" (valueChange)="autoCustomFilter(property)"></editor>
                            </ng-container>
                        </ng-container>
                        <ng-container *ngSwitchCase="DataType.DropDown">
                            <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ type: property.type, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: '', placeholder: property.placeholder}" (valueChange)="autoCustomFilter(property)"></editor>
                        </ng-container>
                        <ng-container *ngSwitchCase="DataType.Boolean">
                            <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ type: property.type, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: '', dataType: DataType.DropDown, loadType: DropdownLoadType.All }" (valueChange)="autoCustomFilter(property)"></editor>
                        </ng-container>
                        <ng-container *ngSwitchCase="DataType.Number">
                            <div class="row d-flex" *ngIf="property.lookup">
                                <div class="col-sm-3" style="padding-right: 5px;">
                                    <label style="white-space: nowrap;">{{ property.label }}</label>
                                    <editor-combobox [items]="property.lookup.items" [decorator]="{ autoSelect: true }" [(value)]="property.compareType"></editor-combobox>
                                </div>
                                <div class="col-sm-9" style="padding-left: 5px;">
                                    <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ label: ' ', type: property.type, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: '', placeholder: property.placeholder}"></editor>
                                </div>
                            </div>
                            <div class="row d-flex" *ngIf="!property.lookup">
                                <div class="col-sm-6" style="padding-right: 5px;">
                                    <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ placeholder: 'Từ', type: property.type, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: ''}"></editor>
                                </div>
                                <div class="col-sm-6" style="padding-left: 5px;">
                                    <editor [(object)]="objFilter2" [property]="property.property" [decorator]="{ label: ' ', placeholder: 'Đến', type: property.type, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: ''}"></editor>
                                </div>
                            </div>
                        </ng-container>
                        <ng-container *ngSwitchDefault>
                            <editor [(object)]="objFilter" [property]="property.property" [decorator]="{ type: property.type, required: false, allowClear: property.allowClear, autoSelect: false, readonly: false, key: '', placeholder: property.placeholder}" (valueChange)="autoCustomFilter(property)"></editor>
                        </ng-container>
                    </ng-container>
                </div>
                <div class="col-lg-3 kt-margin-t-15" *ngFor="let item of filterLength;"></div>
                <div class="col-lg-3 kt-margin-t-15">
                    <label *ngIf="customFilters.length % 4 > 0">&nbsp;</label>
                    <div class="button_custom_filters">
                        <button class="btn btn-info btn-brand--icon mr-2" (click)="customFilter()">
                            <span>
                                <i class="la la-search"></i>
                                <span>Tìm kiếm</span>
                            </span>
                        </button>
                        <!-- <button class="btn btn-success btn-brand--icon mr-2" (click)="saveRequestFilter()" *ngIf="!obj.IsPopup"> 
                            <span>
                                <i class="la la-save"></i>
                                <span>{{ windowWidth <= 1368 ? 'Lưu' : 'Lưu bộ lọc' }}</span>
                            </span>
                        </button> -->
                        <button class="btn btn-secondary btn-secondary--icon" (click)="clearCustomFilter()">
                            <span>
                                <i class="la la-close"></i>
                                <span>{{ windowWidth <= 1368 ? 'Xóa' : 'Thiết lập lại' }}</span>
                                </span>
                        </button>
                    </div>
                </div>
            </div>
        </form>
        <ng-template #containerEmbed></ng-template>
        <div class="row row-embed" *ngIf="statisticals && statisticals.length > 0">
            <ng-container>
                <label class="col-sm-3 col-form-label" *ngFor="let item of statisticals">{{ item.label }}: <b>{{ item.value }}</b></label>
            </ng-container>
        </div>
        <div *ngIf="items && items.length > 0">
            <div class="paging_fix" [ngClass]="{'paging_flex':obj.ItemComponent}" *ngIf="!obj.HidePaging && (!obj.PagingPositionType || obj.PagingPositionType == PagingPositionType.Top || obj.PagingPositionType == PagingPositionType.Both)">
                <div *ngIf="obj.ItemComponent && (obj.Checkable || obj.Radioable)" class="kt-checkbox-all">
                    <label class="kt-checkbox kt-checkbox--single kt-checkbox--solid kt-checkbox--brand" *ngIf="obj.Checkable">
                        <input type="checkbox" class="kt-checkable" [checked]="checkAll" [(ngModel)]="checkAll" (change)="checkAllChange()"> <span></span>
                    </label>
                    <span> Chọn tất cả</span>
                </div>
                <paging [selected]="selectedCount" [loading]="loading" [timerReload]="obj.TimerReload" [sizes]="obj.PageSizes" [paging]="itemData.Paging" (pagingChange)="pageChanged($event)" [summaryText]="summaryText" text="Tổng số tiền (đ): " [total]="itemTotal"></paging>
            </div>
            <div class="grid-content" [ngClass]="{'grid-popup':obj.IsPopup, 'grid-scroll':items.length >= 3, 'grid-scroll-x':obj.ScrollX, 'grid-list':obj.ItemComponent}">
                <table class="table table-striped table-bordered table-hover table-checkable dataTable no-footer table-resizable" *ngIf="!obj.ItemComponent">
                    <thead>
                        <tr *ngIf="groupActiveProperties && groupActiveProperties.length > 0" class="group-heading">
                            <th *ngFor="let item of groupActiveProperties; let i = index;" [attr.colspan]="item.ColSpan">
                                {{ item.ColSpanTitle }}
                            </th>
                        </tr>
                        <tr class="heading" (clickOutside)="closeFilterMenu()">
                            <th *ngIf="hasChild" style="width: 30px; text-align: center;"></th>
                            <th *ngIf="obj.Checkable || obj.Radioable" style="width: 40px; text-align: center;">
                                <label class="kt-checkbox kt-checkbox--single kt-checkbox--solid kt-checkbox--brand" *ngIf="obj.Checkable">
                                    <input type="checkbox" class="kt-checkable" [checked]="checkAll" [(ngModel)]="checkAll" (change)="checkAllChange()"> <span></span>
                                </label>
                            </th>
                            <th *ngFor="let item of activeProperties; let i = index;" (click)="sort(item)" [style.min-width]="item.Property == 'Id' ? '60px' : (item.ColumnWidth ? item.ColumnWidth + 'px' : '')" [ngClass]="{'filtering':item.AllowFilter, 'sorting': !item.DisableOrder, 'sorting_asc':item.Order == OrderType.Asc, 'sorting_desc':item.Order == OrderType.Desc}">
                                <div class="btn-group filter" *ngIf="item.AllowFilter">
                                    <span (click)="toggleFilterMenu(item)">
                                        <i class="la la-filter" [ngClass]="{'active':item.ActiveFilter}"></i>
                                    </span>
                                    <div class="dropdown-menu portlet light" [ngClass]="{'active':item.ActiveFilter}">
                                        <div class="kt-portlet__body">
                                            <ul class="nav nav-tabs  nav-tabs-line nav-tabs-line-success">
                                                <li class="nav-item">
                                                    <a class="nav-link" (click)="activeTabFilterMenu(item, TabFilterType.Basic)" [ngClass]="{'active':!item.TabFilterType || item.TabFilterType == TabFilterType.Basic}">
                                                        Cơ bản
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" (click)="activeTabFilterMenu(item, TabFilterType.Advance)" [ngClass]="{'active':item.TabFilterType == TabFilterType.Advance}">
                                                        Nâng cao
                                                    </a>
                                                </li>
                                            </ul>
                                            <div class="tab-content">
                                                <div class="tab-pane" [ngClass]="{'active':!item.TabFilterType || item.TabFilterType == TabFilterType.Basic}">
                                                    <ng-container [ngSwitch]="item.Type">
                                                        <ng-container *ngSwitchCase="DataType.String">
                                                            <div style="margin-bottom: 10px;">
                                                                <editor-textbox [decorator]="{label: '', placeholder: 'Tìm kiếm', type: StringType.Search}" (valueChange)="itemFilterSearchChange($event, item)">
                                                                </editor-textbox>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="DataType.Boolean">
                                                            <div>
                                                                <editor-checkbox [decorator]="{label: 'Chọn tất cả'}">
                                                                </editor-checkbox>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="DataType.DropDown">
                                                            <div>
                                                                <editor-checkbox [decorator]="{label: 'Chọn tất cả'}">
                                                                </editor-checkbox>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="DataType.Number">
                                                            <div style="margin-bottom: 10px;">
                                                                <editor-textbox [decorator]="{label: '', placeholder: 'Tìm kiếm', type: StringType.Search}" (valueChange)="itemFilterSearchChange($event, item)">
                                                                </editor-textbox>
                                                            </div>
                                                        </ng-container>
                                                    </ng-container>
                                                    <div class="dropdown-divider"></div>
                                                    <ul class="kt-checkbox-list" scrollTracker (scrollingFinished)="onScroll(item)">
                                                        <li *ngFor="let itm of item.ItemFilters">
                                                            <editor-checkbox [(value)]="itm.selected" [decorator]="{label: itm.label}"></editor-checkbox>
                                                        </li>
                                                        <li class="item-loading" *ngIf="item.LoadingFilter">
                                                            <div class="kt-spinner kt-spinner--v2 kt-spinner--primary ">
                                                                <span>Đang tải...</span>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="tab-pane" [ngClass]="{'active':item.TabFilterType == TabFilterType.Advance}">
                                                    <ul class="kt-checkbox-list">
                                                        <li class="form-group">
                                                            <label>So sánh</label>
                                                            <div>
                                                                <ng-container [ngSwitch]="item.Type">
                                                                    <ng-container *ngSwitchCase="DataType.String">
                                                                        <editor-combobox [items]="stringFilterTypes" [decorator]="{placeholder:'Chọn'}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.Boolean">
                                                                        <editor-combobox [items]="boolFilterTypes" [decorator]="{placeholder:'Chọn'}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.Number">
                                                                        <editor-combobox [items]="numberFilterTypes" [decorator]="{placeholder:'Chọn'}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.DateTime">
                                                                        <editor-combobox [items]="datetimeFilterTypes" [decorator]="{placeholder:'Chọn'}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.DropDown">
                                                                        <editor-combobox [items]="foreignFilterTypes" [decorator]="{placeholder:'Chọn'}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchDefault>
                                                                        <editor-combobox [items]="stringFilterTypes" [decorator]="{placeholder:'Chọn'}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </div>
                                                        </li>
                                                        <li class="form-group" style="margin-top: 10px;">
                                                            <label>Giá trị</label>
                                                            <div>
                                                                <ng-container [ngSwitch]="item.Type">
                                                                    <ng-container *ngSwitchCase="DataType.String">
                                                                        <editor-textbox [decorator]="{placeholder:'Giá trị'}">
                                                                        </editor-textbox>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.Boolean">
                                                                        <editor-combobox [items]="item.ItemFilters" [decorator]="{placeholder:'Giá trị'}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.Number">
                                                                        <editor-numberic [decorator]="{placeholder:'Giá trị 1-10'}">
                                                                        </editor-numberic>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.DateTime">
                                                                        <editor-datetime [decorator]="{placeholder:'Ngày tháng'}">
                                                                        </editor-datetime>
                                                                    </ng-container>
                                                                    <ng-container *ngSwitchCase="DataType.DropDown">
                                                                        <editor-combobox [items]="item.ItemFilters" [decorator]="{placeholder:'Giá trị', multiple: true}">
                                                                        </editor-combobox>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="btn-group">
                                                <button class="btn btn-primary" (click)="filter(decorator)"> Lọc dữ liệu
                                                    <i class="glyphicon glyphicon-ok"></i></button>
                                                <button class="btn btn-warning" (click)="resetFilter(decorator)">
                                                    Thiết lập lại <i class="glyphicon glyphicon-refresh"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <span *ngIf="item.Property == 'Id' || item.Title == 'Id'; else property_filter_other">
                                    <span>Id</span>
                                </span>
                                <div class="handle-resize"></div>
                                <ng-template #property_filter_other>
                                    <span style="overflow: visible;">
                                        {{ item.Title }} <span *ngIf="item.Tooltip" [attr.tooltip]="item.Tooltip" flow="down" class="grid-header-tooltip"><i class="fa fa-info-circle"></i></span>
                                    </span>
                                </ng-template>
                                <div *ngIf="item.ColumnFilter">
                                    <ng-container [ngSwitch]="item.ColumnFilter.dataType">
                                        <ng-container *ngSwitchCase="DataType.String">
                                            <editor-textbox [(object)]="objFilter" [property]="item.Property" [decorator]="item.ColumnFilter">
                                            </editor-textbox>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="DataType.Boolean">
                                            <editor-combobox [(object)]="objFilter" [property]="item.Property" [decorator]="item.ColumnFilter">
                                            </editor-combobox>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="DataType.Number">
                                            <editor-numberic [(object)]="objFilter" [property]="item.Property" [decorator]="item.ColumnFilter">
                                            </editor-numberic>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="DataType.DateTime">
                                            <editor-datetime [(object)]="objFilter" [property]="item.Property" [decorator]="item.ColumnFilter">
                                            </editor-datetime>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="DataType.DropDown">
                                            <editor-combobox [(object)]="objFilter" [property]="item.Property" [decorator]="item.ColumnFilter">
                                            </editor-combobox>
                                        </ng-container>
                                    </ng-container>
                                </div>
                            </th>
                            <th *ngIf="obj.UpdatedBy">
                                Cập nhật
                            </th>
                            <th class="actions" *ngIf="(obj.Actions && obj.Actions.length > 0) || (obj.MoreActions && obj.MoreActions.length > 0)" [ngClass]="{'td-sticky': !(obj.MoreActions && obj.MoreActions.length > 0)}">
                                Thao tác
                                <div class="choice-column" (clickOutside)="activeChoiceColumn = false">
                                    <a (click)="activeChoiceColumn = !activeChoiceColumn"><i class="la la-list"></i></a>
                                    <div class="dropdown-menu header-filter portlet light dropdown-menu-columns" [ngClass]="{'active':activeChoiceColumn}">
                                        <div class="kt-portlet__body">
                                            <h6>
                                                <editor-checkbox [(value)]="columnActiveAll" [decorator]="{label: 'Chọn cột hiển thị'}" (valueChange)="choiceColumnAllChange()"></editor-checkbox>
                                            </h6>
                                            <ul class="kt-checkbox-list">
                                                <li *ngFor="let column of properties">
                                                    <editor-checkbox [(value)]="column.Active" [decorator]="{label: column.Title}" (valueChange)="choiceColumnChange()"></editor-checkbox>
                                                </li>
                                            </ul>
                                            <button class="btn btn-sm btn-success" (click)="resetColumnsActive()">Mặc định</button>
                                        </div>
                                    </div>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <ng-container *ngFor="let item of items; let i = index;">
                            <tr *ngIf="!item.Editable" [ngClass]="{'odd': i % 2 == 0, 'even': i % 2 != 0, 'clicked': item.rowClicked}" (dblclick)="rowDoubleClick(item)">
                                <td *ngIf="hasChild" style="width: 30px; text-align: center;">
                                    <a *ngIf="item.HasChild" class="datatable-toggle-detail" (click)="toggleSubTable(item)">
                                        <i [ngClass]="item.ActiveChild ? 'fa fa-caret-down' : 'fa fa-caret-right'"></i>
                                    </a>
                                </td>
                                <td *ngIf="obj.Checkable || obj.Radioable" style="width: 40px; text-align: center;">
                                    <label class="kt-checkbox kt-checkbox--single kt-checkbox--solid kt-checkbox--brand" *ngIf="obj.Checkable && item.Checkable" [ngClass]="{'kt-disabled':item.ReadOnlyCheckable}">
                                        <input type="checkbox" class="kt-checkable" [(ngModel)]="item.Checked" (change)="checkChange($event, item)"> <span></span>
                                    </label>
                                    <label class="kt-radio kt-radio--single kt-radio--solid kt-radio--brand" *ngIf="obj.Radioable && item.Checkable" [ngClass]="{'kt-disabled':item.ReadOnlyCheckable}">
                                        <input type="radio" [attr.name]="obj.ReferenceName" class="kt-checkable" [(ngModel)]="item.Checked" (change)="checkRadioChange($event, item)"> <span></span>
                                    </label>
                                </td>
                                <td *ngFor="let column of activeProperties" [ngClass]="(column.ClassName ? column.ClassName : '') + (column.Property == 'Id' || column.Title == 'Id' ? 'column-id': '')" [style.min-width]="column.Property == 'Id' ? '60px' : (column.ColumnWidth ? column.ColumnWidth + 'px' : '')" [style.textAlign]="column.Align" [attr.data-label]="column.Title">
                                    <span *ngIf="column.Property == 'Id' || column.Title == 'Id'; else property_other" [ngClass]="{'d-flex': obj.Checkable}" (click)="columlClick($event, item)">
                                        <span *ngIf="item[column.Property]" [innerHTML]="item[column.Property] | sanitizeHtml"></span>
                                    </span>
                                    <ng-template #property_other>
                                        <ng-container [ngSwitch]="column.Type">
                                            <ng-container *ngSwitchCase="DataType.String">
                                                <div [innerHTML]="item[column.Property] | sanitizeHtml" [ngClass]="item[column.Property + '_Color']" *ngIf="!column.Click && (column.Format || column.FormatAsync)" (click)="columlClick($event, item)"></div>
                                                <span [attr.title]="item[column.Property]" [ngClass]="item[column.Property + '_Color']" *ngIf="!column.Click && !column.Format && !column.FormatAsync">
                                                    {{ item[column.Property] }}
                                                </span>
                                                <a [innerHTML]="item[column.Property] | sanitizeHtml" [ngClass]="item[column.Property + '_Color']" *ngIf="column.Click" (click)="cellClick(column, item)">
                                                </a>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="DataType.Number">
                                                <span *ngIf="!column.Click">
                                                    {{ item[column.Property] == null ? '' : (item[column.Property] | numberx) }}
                                                </span>
                                                <a *ngIf="column.Click" (click)="cellClick(column, item)">
                                                    {{ item[column.Property] == null ? '' : (item[column.Property] | numberx) }}
                                                </a>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="DataType.DateTime">
                                                <span *ngIf="!column.PipeType || column.PipeType == PipeType.DateTime">{{ item[column.Property] | datetimex }}</span>
                                                <span *ngIf="column.PipeType == PipeType.Date">{{ item[column.Property] | datex }}</span>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="DataType.Image">
                                                <img [src]="item[column.Property]" style="max-height: 45px; max-width: 300px;" />
                                            </ng-container>
                                            <ng-container *ngSwitchCase="DataType.Boolean">
                                                <editor-checkbox *ngIf="!item[column.Property + '_Text']" [(value)]="item[column.Property]" [decorator]="{'readonly':true}">
                                                </editor-checkbox>
                                                <span *ngIf="item[column.Property + '_Text']">
                                                    {{ item[column.Property + '_Text'] }}
                                                </span>
                                            </ng-container>
                                            <ng-container *ngSwitchDefault>
                                                <span [attr.title]="item[column.Property]" [ngClass]="item[column.Property + '_Color']">
                                                    {{ item[column.Property] }}
                                                </span>
                                            </ng-container>
                                        </ng-container>
                                    </ng-template>
                                </td>
                                <td style="width: 200px;" data-label="Cập nhật" *ngIf="obj.UpdatedBy">
                                    <div><i class="far fa-user"></i> {{ item.UpdatedBy || item.CreatedBy }}
                                    </div>
                                    <div><i class="far fa-calendar"></i> {{ (item.UpdatedDate || item.CreatedDate) | datetimex }}
                                    </div>
                                </td>
                                <td class="actions" data-label="Hành động" *ngIf="(obj.Actions && obj.Actions.length > 0) || (obj.MoreActions && obj.MoreActions.length > 0)" [ngClass]="{'td-sticky': !(obj.MoreActions && obj.MoreActions.length > 0)}">
                                    <div class="btn-group">
                                        <span *ngFor="let action of obj.Actions">
                                            <ng-container [ngSwitch]="action.systemName">
                                                <ng-container *ngSwitchCase="ActionType.Publish">
                                                    <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" *ngIf="!item.IsDelete && (!action.hidden || !action.hidden(item))" [attr.tooltip]="item.IsActive ? 'Gỡ xuống' : 'Xuất bản'" [attr.flow]="i == 0 ? 'left' : 'up'">
                                                        <i [ngClass]="item.IsActive ? 'la la-power-off' : 'la la-check-circle'"></i>
                                                    </a>
                                                </ng-container>
                                                <ng-container *ngSwitchCase="ActionType.Delete">
                                                    <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" *ngIf="!action.hidden || !action.hidden(item)" [attr.tooltip]="item.IsDelete ? 'Khôi phục' : 'Xóa'" [attr.flow]="i == 0 ? 'left' : 'up'">
                                                        <i [ngClass]="item.IsDelete ? 'la la-reply-all' : 'la la la-trash'"></i>
                                                    </a>
                                                </ng-container>
                                                <ng-container *ngSwitchDefault>
                                                    <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" *ngIf="!item.IsDelete && (!action.hidden || !action.hidden(item))" [attr.tooltip]="action.name" [attr.flow]="i == 0 ? 'left' : 'up'">
                                                        <i [ngClass]="action.icon" (ctrl-click)="action.ctrClick(item)"></i>
                                                    </a>
                                                </ng-container>
                                            </ng-container>
                                        </span>
                                        <span *ngIf="!item.IsDelete && obj.MoreActions && obj.MoreActions.length > 0">
                                            <dropdown [direction]="items.length > 3 && i >= items.length - 3 ? 'top' : 'bottom'" [items]="obj.MoreActions" [obj]="item" cssClass="btn-default btn-sm btn-icon-sm" icon="la la-ellipsis-h"></dropdown>
                                        </span>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="item.Editable && itemEditable && itemEditable.Id">
                                <td *ngIf="hasChild" style="width: 30px; text-align: center;">
                                    &nbsp;
                                </td>
                                <td *ngIf="obj.Checkable || obj.Radioable" style="width: 40px; text-align: center;">
                                    &nbsp;
                                </td>
                                <td *ngFor="let column of editActiveProperties" [ngClass]="(column.ClassName ? column.ClassName : '') + (column.Property == 'Id' || column.Title == 'Id' ? 'column-id': '')" [style.min-width]="column.Property == 'Id' ? '60px' : (column.ColumnWidth ? column.ColumnWidth + 'px' : '')" [style.textAlign]="column.Align" [attr.data-label]="column.Title">
                                    <span *ngIf="column.viewer || column.property == 'Id'; else property_edit_other" [ngClass]="{'d-flex': obj.Checkable}">
                                        <span *ngIf="item[column.property] != null" [innerHTML]="item[column.property] | sanitizeHtml"></span>
                                    </span>
                                    <ng-template #property_edit_other>
                                        <editor #upload [(object)]="itemEditable" [property]="column.property" [decorator]="{label: ''}" (valueChange)="editValueChange($event, column)"></editor>
                                    </ng-template>
                                </td>
                                <td style="width: 200px;" data-label="Cập nhật" *ngIf="obj.UpdatedBy">
                                    &nbsp;
                                </td>
                                <td class="actions" data-label="Hành động" *ngIf="(obj.EditActions && obj.EditActions.length > 0)">
                                    <div class="btn-group">
                                        <span *ngFor="let action of obj.EditActions">
                                            <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" [attr.tooltip]="action.name" [attr.flow]="i == 0 ? 'left' : 'up'">
                                                <i [ngClass]="action.icon" (ctrl-click)="action.ctrClick(item)"></i>
                                            </a>
                                        </span>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="item.ActiveChild">
                                <td colspan="100" class="sub-table">
                                    <div #containerChilds [id]="'child_template_' + (item.Id || item._id)"></div>
                                </td>
                            </tr>
                        </ng-container>
                        <tr *ngIf="itemEditable && !itemEditable.Id">
                            <td *ngIf="hasChild" style="width: 30px; text-align: center;">
                                &nbsp;
                            </td>
                            <td *ngIf="obj.Checkable || obj.Radioable" style="width: 40px; text-align: center;">
                                &nbsp;
                            </td>
                            <td *ngFor="let column of editActiveProperties" [ngClass]="(column.ClassName ? column.ClassName : '') + (column.Property == 'Id' || column.Title == 'Id' ? 'column-id': '')" [style.min-width]="column.Property == 'Id' ? '60px' : (column.ColumnWidth ? column.ColumnWidth + 'px' : '')" [style.textAlign]="column.Align" [attr.data-label]="column.Title">
                                <span *ngIf="column.viewer || column.property == 'Id'; else property_edit_other" [ngClass]="{'d-flex': obj.Checkable}">
                                    <span *ngIf="item[column.property] != null" [innerHTML]="item[column.property] | sanitizeHtml"></span>
                                </span>
                                <ng-template #property_addnew_other>
                                    <editor #upload [(object)]="itemEditable" [property]="column.property" [decorator]="{label: ''}" (valueChange)="editValueChange($event, column)"></editor>
                                </ng-template>
                            </td>
                            <td style="width: 200px;" data-label="Cập nhật" *ngIf="obj.UpdatedBy">
                                &nbsp;
                            </td>
                            <td class="actions" data-label="Hành động" *ngIf="(obj.EditActions && obj.EditActions.length > 0)">
                                <div class="btn-group">
                                    <span *ngFor="let action of obj.EditActions">
                                        <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" [attr.tooltip]="action.name" [attr.flow]="i == 0 ? 'left' : 'up'">
                                            <i [ngClass]="action.icon" (ctrl-click)="action.ctrClick(item)"></i>
                                        </a>
                                    </span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot *ngIf="activeTotalProperties && activeTotalProperties.length > 0 && totalItem && items && items.length > 0">
                        <tr>
                            <td [attr.colspan]="mergeCount">
                                <span>{{ obj.TotalTitle || 'Tổng' }}</span>
                            </td>
                            <td *ngFor="let column of activeTotalProperties;" [attr.colspan]="column.ColSpan">
                                <div [innerHTML]="totalItem[column.Property] | sanitizeHtml"></div>
                            </td>
                            <td *ngFor="let column of [].constructor(notMergeCount);">
                            </td>
                        </tr>
                    </tfoot>
                </table>
                <ng-container *ngIf="obj.ItemComponent">
                    <div class="grid-item" *ngFor="let item of items; let i = index;" [ngClass]="{'checked': item.Checked}" (click)="toggleCheckChange(item)">
                        <div #containerComponents [id]="'component_template_' + (item.Id || item._id)"></div>
                        <div class="actions" data-label="Hành động" *ngIf="obj.Actions && obj.Actions.length > 0">
                            <span *ngFor="let action of obj.Actions">
                                <ng-container [ngSwitch]="action.systemName">
                                    <ng-container *ngSwitchCase="ActionType.Publish">
                                        <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" *ngIf="!item.IsDelete && (!action.hidden || !action.hidden(item))" [attr.tooltip]="item.IsActive ? 'Gỡ xuống' : 'Xuất bản'" [attr.flow]="'left'">
                                            <i [ngClass]="item.IsActive ? 'la la-power-off' : 'la la-check-circle'"></i>
                                        </a>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="ActionType.Delete">
                                        <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" *ngIf="!action.hidden || !action.hidden(item)" [attr.tooltip]="item.IsDelete ? 'Khôi phục' : 'Xóa'" [attr.flow]="'left'">
                                            <i [ngClass]="item.IsDelete ? 'la la-reply-all' : 'la la la-trash'"></i>
                                        </a>
                                    </ng-container>
                                    <ng-container *ngSwitchDefault>
                                        <a class="btn btn-sm btn-icon btn-icon-md" [ngClass]="action.className" (click)="action.click(item)" *ngIf="!item.IsDelete && (!action.hidden || !action.hidden(item))" [attr.tooltip]="action.name" [attr.flow]="'left'">
                                            <i [ngClass]="action.icon" (ctrl-click)="action.ctrClick(item)"></i>
                                        </a>
                                    </ng-container>
                                </ng-container>
                            </span>
                        </div>
                        <div class="grid-checked" *ngIf="item.Checkable" [ngClass]="{'checked': item.Checked}">
                            <i class="la la-check"></i>
                        </div>
                    </div>
                </ng-container>
            </div>
            <div class="paging_fix" *ngIf="!obj.HidePaging && obj.PagingPositionType == PagingPositionType.Bottom || obj.PagingPositionType == PagingPositionType.Both" style="margin-top: 10px;">
                <paging [selected]="selectedCount" [loading]="loading" [timerReload]="obj.TimerReload" [sizes]="obj.PageSizes" [paging]="itemData.Paging" (pagingChange)="pageChanged($event)" [summaryText]="summaryText" text="Tổng số tiền (đ): " [total]="itemTotal"></paging>
            </div>
        </div>
        <div *ngIf="!items || items.length == 0" style="padding: 25px 0;">
            <em [innerHTML]="message"></em>
        </div>
        <loading *ngIf="loading" [text]="loadingText"></loading>
        <div *ngIf="(!items || items.length == 0) && loading && !obj.HideSkeletonLoading">
            <ngx-skeleton-loader [count]="obj.IsPopup ? 3: 10" appearance="line" [theme]="{ 'border-radius': '5px', height: '50px' }"></ngx-skeleton-loader>
        </div>
    </div>
</div>
<div *ngIf="prepareForm">
    <edit-popup></edit-popup>
</div>
<div *ngIf="prepareFormAuto">
    <edit-popup-auto></edit-popup-auto>
</div>
<input #fileInput type="file" (change)="selectedFile($event)" style="width: 100%; height: 100%; display: none;">